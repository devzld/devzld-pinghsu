<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="renderer" content="webkit">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta http-equiv="Cache-Control" content="no-transform"/>
    <meta http-equiv="Cache-Control" content="no-siteapp"/>
    <title>异常android.database.CursorWindowAllocationException</title>
	<meta name="description" content="">
	<link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/devzld/devzld.github.io@718f11578b834c5267e68b8d3900cf06da0c9c56/style/image/favicon.png">
    <link rel="apple-touch-icon" href="https://cdn.jsdelivr.net/gh/devzld/devzld.github.io@718f11578b834c5267e68b8d3900cf06da0c9c56/style/image/favicon.png"/>
    <link href="https://cdn.jsdelivr.net/gh/devzld/devzld.github.io@718f11578b834c5267e68b8d3900cf06da0c9c56/style/css/highlight.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/gh/devzld/devzld.github.io@718f11578b834c5267e68b8d3900cf06da0c9c56/style/css/style.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/devzld/devzld.github.io@718f11578b834c5267e68b8d3900cf06da0c9c56/style/css/iconfont/iconfont.css">

    <style>
        #搜索区 {
            max-width: 40em;
            padding: 1em;
            margin: 1em auto;
            border: 1px solid lightgrey;
            margin-top: 100px;
        }
        #搜索输入 {
            display: inline-block;
            padding: .5em;
            width: 100%;
            font-size: 0.8em;
            -webkit-box-sizing: border-box;
            -moz-box-sizing: border-box;
            box-sizing: border-box;
        }
    </style>
</head>

<body class="bg-grey" gtools_scp_screen_capture_injected="true">

    <header id="header" class="header bg-white">
    <div class="navbar-container">
        <a href="/" class="navbar-logo">
<!--            <img src="/style/image/logo.png" alt="星光的个人博客" />-->
            <span>星光的个人博客</span>
        </a>
        <div class="navbar-menu">
            <a href="/archives">归档</a>
            <a href="/about">关于</a>
        </div>
        <div class="navbar-mobile-menu" onclick="">
            <span class="icon-menu cross"><span class="middle"></span></span>
            <ul>
                <li><a href="/archives">归档</a></li>
                <li><a href="/about">关于</a></li>
            </ul>
        </div>
    </div>
</header>

    <article class="main-content page-page" itemscope itemtype="http://schema.org/Article">
    <div class="post-header">
        <h1 class="post-title" itemprop="name headline">
            异常android.database.CursorWindowAllocationException
        </h1>
        <div class="post-data">
            <time itemprop="datePublished">Oct 24, 2019</time>
        </div>
    </div>
</article>
<div class="main-container">
    <div class="post-container">
        <!--<div class="navigation" id="navigation">
            <h1>Contents</h1>
            <ul class="nav sidenav"></ul>
        </div>-->
        <article class="post-content">
            <h3 id="异常信息如下">异常信息如下</h3>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>io.reactivex.exceptions.UndeliverableException: android.database.CursorWindowAllocationException: Cursor window allocation of 2048 kb failed. <span class="c"># Open Cursors=1 (# cursors opened by this proc=1)</span>
	at io.reactivex.plugins.RxJavaPlugins.onError<span class="o">(</span>RxJavaPlugins.java:367<span class="o">)</span>
	at io.reactivex.internal.schedulers.ScheduledRunnable.run<span class="o">(</span>ScheduledRunnable.java:69<span class="o">)</span>
	at io.reactivex.internal.schedulers.ScheduledRunnable.call<span class="o">(</span>ScheduledRunnable.java:57<span class="o">)</span>
	at java.util.concurrent.FutureTask.run<span class="o">(</span>FutureTask.java:237<span class="o">)</span>
	at java.util.concurrent.ScheduledThreadPoolExecutor<span class="nv">$ScheduledFutureTask</span>.access<span class="nv">$201</span><span class="o">(</span>ScheduledThreadPoolExecutor.java:152<span class="o">)</span>
	at java.util.concurrent.ScheduledThreadPoolExecutor<span class="nv">$ScheduledFutureTask</span>.run<span class="o">(</span>ScheduledThreadPoolExecutor.java:265<span class="o">)</span>
	at java.util.concurrent.ThreadPoolExecutor.runWorker<span class="o">(</span>ThreadPoolExecutor.java:1112<span class="o">)</span>
	at java.util.concurrent.ThreadPoolExecutor<span class="nv">$Worker</span>.run<span class="o">(</span>ThreadPoolExecutor.java:587<span class="o">)</span>
	at java.lang.Thread.run<span class="o">(</span>Thread.java:818<span class="o">)</span>
Caused by: android.database.CursorWindowAllocationException: Cursor window allocation of 2048 kb failed. <span class="c"># Open Cursors=1 (# cursors opened by this proc=1)</span>
	at android.database.CursorWindow.&lt;init&gt;<span class="o">(</span>CursorWindow.java:108<span class="o">)</span>
	at android.database.AbstractWindowedCursor.clearOrCreateWindow<span class="o">(</span>AbstractWindowedCursor.java:198<span class="o">)</span>
	at android.database.sqlite.SQLiteCursor.fillWindow<span class="o">(</span>SQLiteCursor.java:139<span class="o">)</span>
	at android.database.sqlite.SQLiteCursor.getCount<span class="o">(</span>SQLiteCursor.java:133<span class="o">)</span>
	at org.greenrobot.greendao.AbstractDao.loadAllFromCursor<span class="o">(</span>AbstractDao.java:453<span class="o">)</span>
	at org.greenrobot.greendao.AbstractDao.loadAllAndCloseCursor<span class="o">(</span>AbstractDao.java:203<span class="o">)</span>
	at org.greenrobot.greendao.InternalQueryDaoAccess.loadAllAndCloseCursor<span class="o">(</span>InternalQueryDaoAccess.java:37<span class="o">)</span>
	at org.greenrobot.greendao.query.Query.list<span class="o">(</span>Query.java:89<span class="o">)</span>
	at org.greenrobot.greendao.query.QueryBuilder.list<span class="o">(</span>QueryBuilder.java:427<span class="o">)</span>
	at com.dinghao.uboard.newversion.module.function.OfflineCardFragment.submitCardInfo<span class="o">(</span>OfflineCardFragment.java:119<span class="o">)</span>
	at com.dinghao.uboard.newversion.module.function.OfflineCardFragment.access<span class="nv">$200</span><span class="o">(</span>OfflineCardFragment.java:55<span class="o">)</span>
	at com.dinghao.uboard.newversion.module.function.OfflineCardFragment<span class="nv">$2</span>.onNext<span class="o">(</span>OfflineCardFragment.java:186<span class="o">)</span>
	at com.dinghao.uboard.newversion.module.function.OfflineCardFragment<span class="nv">$2</span>.onNext<span class="o">(</span>OfflineCardFragment.java:178<span class="o">)</span>
	at io.reactivex.internal.operators.observable.ObservableObserveOn<span class="nv">$ObserveOnObserver</span>.drainNormal<span class="o">(</span>ObservableObserveOn.java:200<span class="o">)</span>
	at io.reactivex.internal.operators.observable.ObservableObserveOn<span class="nv">$ObserveOnObserver</span>.run<span class="o">(</span>ObservableObserveOn.java:252<span class="o">)</span>
	at io.reactivex.internal.schedulers.ScheduledRunnable.run<span class="o">(</span>ScheduledRunnable.java:66<span class="o">)</span>
</code></pre></div></div>

<h3 id="原因">原因</h3>
<p>使用rxjava定时器定时处理数据库，线程模式是Schedulers.io()，因为这个模式没有线程限制，导致线程太多，引起此异常</p>

<h3 id="解决">解决</h3>
<p>改用固定线程数，如Schedulers.single()，单个线程</p>

        </article>
        <div class="post-content">
         <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
<script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
<script src="https://cdn.jsdelivr.net/gh/devzld/static@master/blog/md5.min.js"></script>
<div id="gitalk-container"></div>

<script data-no-instant type="text/javascript">
const gitalk = new Gitalk({
  clientID: '1ed81ffadee7491d960d',
  clientSecret: '23951794a420ad09070199a1da082aa8f69574f9',
  repo: 'devzld.github.io',
  owner: 'devzld',
  admin: ['devzld'],
  id: md5(location.pathname),      // Ensure uniqueness and length less than 50
  distractionFreeMode: true  // Facebook-like distraction free mode
})

gitalk.render('gitalk-container')
</script>
        </div>
    </div>
</div>
    
    <footer id="footer" class="footer bg-white">
    <div class="footer-social">
        <div class="footer-container clearfix">
            <div class="social-list">
                <a href="/"><span class='iconfont icon-home'></span>&nbsp;&nbsp;HOME</a>
                <a rel="nofollow" target="_blank" href="https://github.com/devzld"><span class='iconfont icon-github'></span>&nbsp;&nbsp;Github</a>
                <a target="_blank" href="/feed.xml"><span class='iconfont icon-rss'></span>&nbsp;&nbsp;RSS</a>
            </div>
        </div>
    </div>
    <div class="footer-meta">
        <div class="footer-container">
            <div class="meta-item meta-copyright">
                <div class="meta-copyright-info">
                    <!--<a href="https://devzld.github.io" class="info-logo">
                        <img src="/style/image/logo.png" alt="wonder">
                    </a>-->
                    <div class="info-text">
                        <p>Copyright &copy; 2016 - 2019 <a href="https://devzld.github.io"><code>devzld</code></a></p>
                        <p>Powered by <a href="http://jekyllrb.com" target="_blank" rel="nofollow"><code>jekyll</code></a>，theme is <a href="https://github.com/lightfish-zhang/pinghsu-jekyll" target="_blank" rel="nofollow"><code>pinghsu</code></a></p>
                    </div>
                </div>
            </div>

            <div class="meta-item meta-posts">
                <h3 class="meta-title">RECENT POSTS</h3>
                
                    <li>
                        <a href="/2019-10-24-%E4%BD%BF%E7%94%A8jsdelivr%E5%85%8D%E8%B4%B9CDN%E5%8A%A0%E9%80%9F%E4%BD%A0%E7%9A%84%E7%BD%91%E7%AB%99">使用jsdelivr免费CDN加速你的网站</a>
                    </li>
                
                    <li>
                        <a href="/2019-10-24-%E4%B8%80%E6%AC%A1%E5%BC%82%E5%B8%B8OutOfMemoryError">一次异常OutOfMemoryError</a>
                    </li>
                
                    <li>
                        <a href="/2019-10-24-CursorWindowAllocationException%E5%BC%82%E5%B8%B8">异常android.database.CursorWindowAllocationException</a>
                    </li>
                
            </div>

        </div>
    </div>
</footer>
<!--51la统计-->
<script type="text/javascript" src="//js.users.51.la/20433593.js"></script>
<!-- #end -->
<script src="//cdn.bootcss.com/jquery/1.10.1/jquery.min.js"></script>
<script>
	!window.jQuery && document.write(unescape('%3Cscript src="/style/js/jquery.min.js"%3E%3C/script%3E'))
</script>
<script src="https://cdn.jsdelivr.net/gh/devzld/devzld.github.io@718f11578b834c5267e68b8d3900cf06da0c9c56/style/js/headroom.min.js"></script>
<script src="https://cdn.jsdelivr.net/gh/devzld/devzld.github.io@718f11578b834c5267e68b8d3900cf06da0c9c56/style/js/nav.min.js"></script>
<script type="text/javascript">
    var header = new Headroom(document.getElementById("header"), {
        tolerance: 10,
        offset : 80,
        classes: {
            initial: "animated",
            pinned: "slideDown",
            unpinned: "slideUp"
        }
    });
    header.init();
</script>

<script>window.SmoothScrollOptions = { stepSize: 36 }</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/smoothscroll/1.4.8/SmoothScroll.min.js"></script>
<script>
	!window.SmoothScroll && document.write(unescape('%3Cscript src="/style/js/SmoothScroll.min.js"%3E%3C/script%3E'))
</script>



  </body>
</html>
